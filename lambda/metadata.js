!function(e,t){for(var n in t)e[n]=t[n]}(exports,function(e){var t={};function n(i){if(t[i])return t[i].exports;var a=t[i]={i:i,l:!1,exports:{}};return e[i].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(i,a,function(t){return e[t]}.bind(null,a));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=11)}([function(e,t){e.exports=require("core-js/modules/es.object.to-string")},function(e,t){e.exports=require("core-js/modules/es.regexp.to-string")},function(e,t){e.exports=require("core-js/modules/es.string.pad-start")},function(e,t){e.exports=require("dotenv")},function(e,t){e.exports=require("web3")},function(e,t){e.exports=require("stream")},function(e,t){e.exports=require("axios")},function(e,t){e.exports=require("form-data")},function(e,t){e.exports=require("regenerator-runtime/runtime")},function(e,t){e.exports=require("@pinata/sdk")},function(e,t){e.exports=require("path")},function(e,t,n){"use strict";n.r(t);n(0),n(1),n(2),n(8);function i(e,t,n,i,a,r,u){try{var o=e[r](u),p=o.value}catch(e){return void n(e)}o.done?t(p):Promise.resolve(p).then(i,a)}function a(e){return function(){var t=this,n=arguments;return new Promise((function(a,r){var u=e.apply(t,n);function o(e){i(u,a,r,o,p,"next",e)}function p(e){i(u,a,r,o,p,"throw",e)}o(void 0)}))}}function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function y(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?u(e):t}function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=p(e);if(t){var a=p(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return y(this,n)}}var d=n(3),c=n.n(d),m=n(4),f=n.n(m),b=n(5),T=n.n(b),v=(n(9),n(6)),g=n.n(v),w=n(7),h=n.n(w);n(10);c.a.config();var x=process.env,M=x.PINATA_API_KEY,_=x.PINATA_API_SECRET,k=(x.WALLET_PRIVATE_KEY,x.EXTERNAL_URL_BASE,x.WEB3_PROVIDER_ENDPOINT),R=x.CONTRACT_ADDRESS,I=new f.a(k),A=new I.eth.Contract([{inputs:[{internalType:"address",name:"_link",type:"address"},{internalType:"address",name:"_feed",type:"address"}],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"approved",type:"address"},{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"}],name:"Approval",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"operator",type:"address"},{indexed:!1,internalType:"bool",name:"approved",type:"bool"}],name:"ApprovalForAll",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"id",type:"bytes32"}],name:"ChainlinkCancelled",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"id",type:"bytes32"}],name:"ChainlinkFulfilled",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"id",type:"bytes32"}],name:"ChainlinkRequested",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"_balance",type:"uint256"},{indexed:!1,internalType:"uint256",name:"_remaining",type:"uint256"}],name:"LowLINK",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"role",type:"bytes32"},{indexed:!0,internalType:"bytes32",name:"previousAdminRole",type:"bytes32"},{indexed:!0,internalType:"bytes32",name:"newAdminRole",type:"bytes32"}],name:"RoleAdminChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"role",type:"bytes32"},{indexed:!0,internalType:"address",name:"account",type:"address"},{indexed:!0,internalType:"address",name:"sender",type:"address"}],name:"RoleGranted",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"role",type:"bytes32"},{indexed:!0,internalType:"address",name:"account",type:"address"},{indexed:!0,internalType:"address",name:"sender",type:"address"}],name:"RoleRevoked",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"from",type:"address"},{indexed:!0,internalType:"address",name:"to",type:"address"},{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"}],name:"Transfer",type:"event"},{inputs:[],name:"ADMIN_ROLE",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"ANIMATION_COUNT",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"ANIMATOR_ROLE",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"ARTIST_PRINTS",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"ARTIST_ROLE",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"BETA_SALE",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"DEFAULT_ADMIN_ROLE",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"LINK_ROLE",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"TOKEN_LIMIT",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"TREASURER_ROLE",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"approve",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"}],name:"balanceOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"baseURI",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"string",name:"_seed",type:"string"},{internalType:"uint8",name:"shapes",type:"uint8"},{internalType:"uint16[6]",name:"palette",type:"uint16[6]"},{internalType:"int16[13]",name:"dials",type:"int16[13]"}],name:"buy",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"payable",type:"function"},{inputs:[],name:"currentLinkPrice",outputs:[{internalType:"uint256",name:"price",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"currentPrice",outputs:[{internalType:"uint256",name:"price",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"getApproved",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"}],name:"getRoleAdmin",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"},{internalType:"uint256",name:"index",type:"uint256"}],name:"getRoleMember",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"}],name:"getRoleMemberCount",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"},{internalType:"address",name:"account",type:"address"}],name:"grantRole",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"},{internalType:"address",name:"account",type:"address"}],name:"hasRole",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"address",name:"operator",type:"address"}],name:"isApprovedForAll",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"linkPremium",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_id",type:"uint256"}],name:"linkPriceAt",outputs:[{internalType:"uint256",name:"price",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"name",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"",type:"bytes32"}],name:"nonces",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"bytes",name:"data",type:"bytes"}],name:"onTokenTransfer",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"ownerOf",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_id",type:"uint256"}],name:"priceAt",outputs:[{internalType:"uint256",name:"price",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"priceIncrease",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"requestId",type:"bytes32"},{internalType:"uint256",name:"randomness",type:"uint256"}],name:"rawFulfillRandomness",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"},{internalType:"address",name:"account",type:"address"}],name:"renounceRole",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"_keyHash",type:"bytes32"},{internalType:"uint256",name:"_fee",type:"uint256"},{internalType:"uint256",name:"_seed",type:"uint256"}],name:"requestRandomness",outputs:[{internalType:"bytes32",name:"requestId",type:"bytes32"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"},{internalType:"address",name:"account",type:"address"}],name:"revokeRole",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"safeTransferFrom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"bytes",name:"_data",type:"bytes"}],name:"safeTransferFrom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"operator",type:"address"},{internalType:"bool",name:"approved",type:"bool"}],name:"setApprovalForAll",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"startPrice",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes4",name:"interfaceId",type:"bytes4"}],name:"supportsInterface",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"symbol",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_id",type:"uint256"},{internalType:"bool",name:"animate",type:"bool"}],name:"tokenArt",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"index",type:"uint256"}],name:"tokenByIndex",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_id",type:"uint256"}],name:"tokenData",outputs:[{internalType:"uint256",name:"randomness",type:"uint256"},{internalType:"uint8",name:"animation",type:"uint8"},{internalType:"uint8",name:"shapes",type:"uint8"},{internalType:"uint16",name:"hatching",type:"uint16"},{internalType:"uint16[6]",name:"palette",type:"uint16[6]"},{internalType:"uint16[4]",name:"size",type:"uint16[4]"},{internalType:"uint16[4]",name:"spacing",type:"uint16[4]"},{internalType:"int16[3]",name:"mirrorPositions",type:"int16[3]"},{internalType:"uint16",name:"scale",type:"uint16"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"uint256",name:"index",type:"uint256"}],name:"tokenOfOwnerByIndex",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"string",name:"_seed",type:"string"},{internalType:"uint8",name:"shapes",type:"uint8"},{internalType:"uint16[6]",name:"palette",type:"uint16[6]"},{internalType:"int16[13]",name:"dials",type:"int16[13]"},{internalType:"uint8",name:"animation",type:"uint8"},{internalType:"bool",name:"animate",type:"bool"}],name:"tokenTest",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"tokenURI",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"totalSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"transferFrom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_id",type:"uint256"},{internalType:"string",name:"_uri",type:"string"}],name:"updateURI",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"amount",type:"uint256"}],name:"withdrawLINK",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"}],R),O=function(e,t){return{statusCode:t,body:JSON.stringify(e)}},P=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o(e,t)}(p,e);var t,n,i,a=l(p);function p(e){var t,n,i,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),t=a.call(this),n=u(t),r=!1,(i="sent")in n?Object.defineProperty(n,i,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[i]=r,t}return t=p,(n=[{key:"_read",value:function(){this.sent?this.push(null):(this.push(Buffer.from(this.str)),this.sent=!0)}}])&&r(t.prototype,n),i&&r(t,i),p}(T.a);function S(e){return new Promise((function(t,n){I.eth.subscribe("logs",{address:R,fromBlock:0,topics:["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x0000000000000000000000000000000000000000000000000000000000000000",null,"0x"+e.toString(16).padStart(64,"0")]}).on("data",function(){var e=a(regeneratorRuntime.mark((function e(i){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("...Minted Block..."),I.eth.getBlock(i.blockNumber,(function(e,i){e?n(e):t(i)}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}))}exports.handler=function(){var e=a(regeneratorRuntime.mark((function e(t,n){var i,a,r,u,o,p,s,y,l,d,c,m,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,i=t.queryStringParameters.id,console.log(R),"GET"===t.httpMethod){e.next=8;break}return console.log("Bad method:",t.httpMethod),e.abrupt("return",O("Bad method:"+t.httpMethod,405));case 8:if(void 0!==i){e.next=11;break}return console.log("Undefined ID parameter is required"),e.abrupt("return",O("Undefined ID parameter is required",204));case 11:return console.log("Checking token of ID ",i," exists"),e.next=14,A.methods.ownerOf(i).call();case 14:if("0x0000000000000000000000000000000000000000"!==e.sent){e.next=18;break}return console.log("Token "+i+" dosn't exist"),e.abrupt("return",O("Token "+i+" dosn't exist",204));case 18:return console.log("Looking Up Token..."),console.log("...Data..."),a=A.methods.tokenData(i).call(),console.log("...Art..."),r=A.methods.tokenArt(i,!1).call(),console.log("...Animation..."),u=A.methods.tokenArt(i,!0).call(),console.log("...Mined Block Number..."),o=S(i),console.log("Awaiting requests..."),p="",s="",y="","",e.next=31,a.catch((function(e){return console.error(e)}));case 31:return p=e.sent,e.next=34,r.catch((function(e){return console.error(e)}));case 34:return s=e.sent,e.next=37,u.catch((function(e){return console.error(e)}));case 37:return y=e.sent,e.next=40,o.catch((function(e){return console.error(e)}));case 40:if(e.sent,void 0!==p&&void 0!==s&&void 0!==y){e.next=43;break}return e.abrupt("return",O("Server Error",500));case 43:return console.log("Lookup Complete!"),console.log("Creating ReadableStrings"),l=new P(s),new P(y),console.log("Generating Form Data"),"https://api.pinata.cloud/pinning/pinFileToIPFS",(d=new h.a).append("file",l).then((function(){return console.log("yay")})).catch((function(e){return console.error(e)})),console.log("Uploading Files to IPFS"),c=g.a.post("https://api.pinata.cloud/pinning/pinFileToIPFS",d,{maxContentLength:"Infinity",headers:{"Content-Type":"multipart/form-data; boundary=".concat(d._boundary),pinata_api_key:M,pinata_secret_api_key:_}}),e.next=55,c.catch((function(e){return console.error(e)}));case 55:return m=e.sent,console.log(m),f={},e.abrupt("return",O(f,200));case 61:return e.prev=61,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",O("Server Error",500));case 65:case"end":return e.stop()}}),e,null,[[0,61]])})));return function(t,n){return e.apply(this,arguments)}}()}]));