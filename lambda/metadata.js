!function(e,t){for(var n in t)e[n]=t[n]}(exports,function(e){var t={};function n(a){if(t[a])return t[a].exports;var i=t[a]={i:a,l:!1,exports:{}};return e[a].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(a,i,function(t){return e[t]}.bind(null,i));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=12)}([function(e,t){e.exports=require("core-js/modules/es.object.to-string")},function(e,t){e.exports=require("core-js/modules/es.regexp.to-string")},function(e,t){e.exports=require("core-js/modules/es.string.pad-start")},function(e,t){e.exports=require("dotenv")},function(e,t){e.exports=require("web3")},function(e,t){e.exports=require("stream")},function(e,t){e.exports=require("@pinata/sdk")},function(e,t){e.exports=require("regenerator-runtime/runtime")},function(e,t){e.exports=require("axios")},function(e,t){e.exports=require("form-data")},function(e,t){e.exports=require("path")},function(e,t){e.exports=require("fs")},function(e,t,n){"use strict";n.r(t);n(0),n(1),n(2),n(7);function a(e,t,n,a,i,r,u){try{var p=e[r](u),o=p.value}catch(e){return void n(e)}p.done?t(o):Promise.resolve(o).then(a,i)}function i(e){return function(){var t=this,n=arguments;return new Promise((function(i,r){var u=e.apply(t,n);function p(e){a(u,i,r,p,o,"next",e)}function o(e){a(u,i,r,p,o,"throw",e)}p(void 0)}))}}function r(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function y(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?u(e):t}function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=o(e);if(t){var i=o(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return y(this,n)}}var d=n(3),c=n.n(d),m=n(4),f=n.n(m),b=n(5),T=n.n(b),v=n(6),g=n.n(v);n(8),n(9),n(10),n(11);c.a.config();var M=process.env,h=M.PINATA_API_KEY,w=M.PINATA_API_SECRET,x=(M.WALLET_PRIVATE_KEY,M.EXTERNAL_URL_BASE),_=M.WEB3_PROVIDER_ENDPOINT,S=M.CONTRACT_ADDRESS,k=new f.a(_),A=new k.eth.Contract([{inputs:[{internalType:"address",name:"rand",type:"address"}],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"approved",type:"address"},{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"}],name:"Approval",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"operator",type:"address"},{indexed:!1,internalType:"bool",name:"approved",type:"bool"}],name:"ApprovalForAll",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"role",type:"bytes32"},{indexed:!0,internalType:"bytes32",name:"previousAdminRole",type:"bytes32"},{indexed:!0,internalType:"bytes32",name:"newAdminRole",type:"bytes32"}],name:"RoleAdminChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"role",type:"bytes32"},{indexed:!0,internalType:"address",name:"account",type:"address"},{indexed:!0,internalType:"address",name:"sender",type:"address"}],name:"RoleGranted",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"role",type:"bytes32"},{indexed:!0,internalType:"address",name:"account",type:"address"},{indexed:!0,internalType:"address",name:"sender",type:"address"}],name:"RoleRevoked",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"from",type:"address"},{indexed:!0,internalType:"address",name:"to",type:"address"},{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"}],name:"Transfer",type:"event"},{inputs:[],name:"ADMIN_ROLE",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"ANIMATION_COUNT",outputs:[{internalType:"uint8",name:"",type:"uint8"}],stateMutability:"view",type:"function"},{inputs:[],name:"ANIMATOR_ROLE",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"ARTIST_ROLE",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"DEFAULT_ADMIN_ROLE",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"SCHEME_COUNT",outputs:[{internalType:"uint8",name:"",type:"uint8"}],stateMutability:"view",type:"function"},{inputs:[],name:"TOKEN_LIMIT",outputs:[{internalType:"uint16",name:"",type:"uint16"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"approve",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"}],name:"balanceOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"baseURI",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"blockStart",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"string",name:"_seed",type:"string"},{internalType:"uint8",name:"shapes",type:"uint8"},{internalType:"uint8",name:"hatching",type:"uint8"},{internalType:"uint16[4]",name:"color",type:"uint16[4]"},{internalType:"uint8[4]",name:"size",type:"uint8[4]"},{internalType:"uint8[2]",name:"spacing",type:"uint8[2]"},{internalType:"address",name:"recipient",type:"address"}],name:"buyFor",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"payable",type:"function"},{inputs:[],name:"currentPrice",outputs:[{internalType:"uint256",name:"price",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"getApproved",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"}],name:"getRoleAdmin",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"},{internalType:"uint256",name:"index",type:"uint256"}],name:"getRoleMember",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"}],name:"getRoleMemberCount",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"},{internalType:"address",name:"account",type:"address"}],name:"grantRole",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"},{internalType:"address",name:"account",type:"address"}],name:"hasRole",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"address",name:"operator",type:"address"}],name:"isApprovedForAll",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"name",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"ownerOf",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"paused",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"phaseCountdown",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"phaseCountdownTime",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"phaseLen",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_id",type:"uint256"}],name:"priceAt",outputs:[{internalType:"uint256",name:"price",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"priceIncrease",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"},{internalType:"address",name:"account",type:"address"}],name:"renounceRole",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"},{internalType:"address",name:"account",type:"address"}],name:"revokeRole",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"safeTransferFrom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"bytes",name:"_data",type:"bytes"}],name:"safeTransferFrom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"operator",type:"address"},{internalType:"bool",name:"approved",type:"bool"}],name:"setApprovalForAll",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"string",name:"_uri",type:"string"}],name:"setBaseURI",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bool",name:"state",type:"bool"}],name:"setPause",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_id",type:"uint256"},{internalType:"string",name:"_uri",type:"string"}],name:"setTokenURI",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"startPrice",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes4",name:"interfaceId",type:"bytes4"}],name:"supportsInterface",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"symbol",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_id",type:"uint256"}],name:"tokenArt",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_id",type:"uint256"},{internalType:"uint8",name:"bkg",type:"uint8"},{internalType:"uint8",name:"duration",type:"uint8"},{internalType:"uint8",name:"options",type:"uint8"}],name:"tokenArt",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"index",type:"uint256"}],name:"tokenByIndex",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_id",type:"uint256"}],name:"tokenData",outputs:[{internalType:"uint256",name:"animation",type:"uint256"},{internalType:"uint8",name:"shapes",type:"uint8"},{internalType:"uint8",name:"hatching",type:"uint8"},{internalType:"uint8[4]",name:"size",type:"uint8[4]"},{internalType:"uint8[2]",name:"spacing",type:"uint8[2]"},{internalType:"uint8",name:"mirroring",type:"uint8"},{internalType:"uint16[3]",name:"color",type:"uint16[3]"},{internalType:"uint8",name:"contrast",type:"uint8"},{internalType:"uint8",name:"shades",type:"uint8"},{internalType:"uint8",name:"scheme",type:"uint8"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"uint256",name:"index",type:"uint256"}],name:"tokenOfOwnerByIndex",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"string",name:"seed",type:"string"},{internalType:"uint8",name:"shapes",type:"uint8"},{internalType:"uint8",name:"hatching",type:"uint8"},{internalType:"uint16[4]",name:"color",type:"uint16[4]"},{internalType:"uint8[4]",name:"size",type:"uint8[4]"},{internalType:"uint8[2]",name:"spacing",type:"uint8[2]"},{internalType:"uint8[4]",name:"traits",type:"uint8[4]"},{internalType:"uint8[3]",name:"settings",type:"uint8[3]"},{internalType:"uint256",name:"id",type:"uint256"}],name:"tokenPreview",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"tokenURI",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"totalSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"transferFrom",outputs:[],stateMutability:"nonpayable",type:"function"}],S),I=function(e,t){return{statusCode:t,body:JSON.stringify(e)}};T.a;function R(e){return new Promise((function(t,n){k.eth.subscribe("logs",{address:S,fromBlock:0,topics:["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x0000000000000000000000000000000000000000000000000000000000000000",null,"0x"+e.toString(16).padStart(64,"0")]}).on("data",function(){var e=i(regeneratorRuntime.mark((function e(a){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("...Minted Block..."),k.eth.getBlock(a.blockNumber,(function(e,a){e?n(e):t(a)}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}))}exports.handler=function(){var e=i(regeneratorRuntime.mark((function e(t,n){var a,i,r,u,p,o,s,y,l,d,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,a=parseInt(t.queryStringParameters.id,10),console.log(S),"GET"===t.httpMethod){e.next=8;break}return console.log("Bad method:",t.httpMethod),e.abrupt("return",I("Bad method:"+t.httpMethod,405));case 8:if(void 0!==a){e.next=11;break}return console.log("Undefined ID parameter is required"),e.abrupt("return",I("Undefined ID parameter is required",204));case 11:return console.log("Checking token of ID ",a," exists"),e.next=14,A.methods.ownerOf(a).call();case 14:if("0x0000000000000000000000000000000000000000"!==e.sent){e.next=18;break}return console.log("Token "+a+" dosn't exist"),e.abrupt("return",I("Token "+a+" dosn't exist",204));case 18:return console.log("Looking Up Token..."),console.log("...Data..."),i=A.methods.tokenData(a).call(),console.log("...Art..."),r=A.methods.tokenArt(a).call(),console.log("...Mined Block Number..."),u=R(a),console.log("Awaiting requests..."),o=(p=["","","",""])[0],s=p[1],y=p[2],e.next=29,i.catch((function(e){return console.error(e)}));case 29:return o=e.sent,e.next=32,r.catch((function(e){return console.error(e)}));case 32:return s=e.sent,e.next=35,u.catch((function(e){return console.error(e)}));case 35:if(y=e.sent,void 0!==o&&void 0!==s){e.next=38;break}return e.abrupt("return",I("Server Error",500));case 38:return console.log("Lookup Complete!"),console.log("Connecting to Pinata SDK..."),g()(h,w),console.log("Building Metadata"),l=["Snap Spin 90","Snap Spin 180","Snap Spin 270","Snap Spin Tri","Snap Spin Quad","Snap Spin Tetra","Spin","Slow Mo","Clockwork","Spread","Staggered Spread","Jitter","Jiggle","Jolt","Grow n Shrink","Squash n Stretch","Round","Glide","Wave","Fade","Skew X","Skew Y","Stretch","Jello"],d=["Triadic","Complimentary","Tetradic","Analogous","Analogous and Complimentary","Split Complimentary","Complimentary and Analogous","Series","Square","Mono"],c={name:"TinyBox #"+a,description:"A scattering of tiny boxes, Arranged in patterns ranging from mundane to magnificent.",external_url:x+a,image_data:s,background_color:"121212",attributes:[{trait_type:"Shapes",value:parseInt(o.shapes)},{trait_type:"Hatching",value:o.hatching},{trait_type:"Spread",value:o.spacing[0]+"%"},{trait_type:"Rows",value:o.spacing[1]%16+1},{trait_type:"Columns",value:Math.floor(o.spacing[1]/16)+1},{trait_type:"Hue",value:parseInt(o.color[0])},{trait_type:"Saturation",value:parseInt(o.color[1])},{trait_type:"Lightness",value:parseInt(o.color[2])},{trait_type:"Contrast",value:parseInt(o.contrast)},{trait_type:"Shades",value:parseInt(o.shades)},{trait_type:"Scheme",value:0===parseInt(o.color[1])?"Grayscale":d[o.scheme]},{trait_type:"Animation",value:l[o.animation]},{trait_type:"Mirroring",value:o.mirroring%4+","+Math.floor(o.mirroring/4)%4+","+Math.floor(o.mirroring/16)%4},{display_type:"date",trait_type:"Created",value:y.timestamp},{display_type:"date",trait_type:"Rendered",value:Date.now()}]},console.log("Metadata of token "+a),console.log(c),e.abrupt("return",I(c,200));case 50:return e.prev=50,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",I("Server Error",500));case 54:case"end":return e.stop()}}),e,null,[[0,50]])})));return function(t,n){return e.apply(this,arguments)}}()}]));